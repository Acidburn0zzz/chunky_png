<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="ChunkyPNG : Read/write access to PNG images in pure Ruby." />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>ChunkyPNG</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/wvanbergen/chunky_png">View on GitHub</a>

          <h1 id="project_title">ChunkyPNG</h1>
          <h2 id="project_tagline">Read/write access to PNG images in pure Ruby.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/wvanbergen/chunky_png/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/wvanbergen/chunky_png/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="chunky-png" class="anchor" href="#chunky-png"><span class="octicon octicon-link"></span></a>Chunky PNG</h1>

<p>This library can read and write PNG files. It is written in pure Ruby for
maximum portability. Let me rephrase: it does NOT require RMagick or any other
memory leaking image library.</p>

<ul>
<li>Source code: <a href="http://github.com/wvanbergen/chunky_png/tree">http://github.com/wvanbergen/chunky_png/tree</a>
</li>
<li>RDoc: <a href="http://rdoc.info/gems/chunky_png/frames">http://rdoc.info/gems/chunky_png/frames</a>
</li>
<li>Wiki: <a href="http://github.com/wvanbergen/chunky_png/wiki">http://github.com/wvanbergen/chunky_png/wiki</a>
</li>
<li>Issue tracker: <a href="http://github.com/wvanbergen/chunky_png/issues">http://github.com/wvanbergen/chunky_png/issues</a>
</li>
</ul><h2>
<a name="features" class="anchor" href="#features"><span class="octicon octicon-link"></span></a>Features</h2>

<ul>
<li>Decodes any image that the PNG standard allows. This includes all standard
color modes, all bit depths and all transparency, interlacing and filtering options.</li>
<li>Encodes images supports all color modes (true color, grayscale and indexed)
and transparency for all these color modes. The best color mode will be
chosen automatically, based on the amount of used colors.</li>
<li>R/W access to the image's pixels.</li>
<li>R/W access to all image metadata that is stored in chunks.</li>
<li>Memory efficient (uses a Fixnum, i.e. 4 or 8 bytes of memory per pixel, depending
on the hardware)</li>
<li>Reasonably fast for Ruby standards, by only using integer math and a highly
optimized saving routine.</li>
<li>Interoperability with RMagick if you really have to.</li>
</ul><p>Also, have a look at OilyPNG at <a href="http://github.com/wvanbergen/oily_png">http://github.com/wvanbergen/oily_png</a>. OilyPNG is a 
mixin module that implements some of the ChunkyPNG algorithms in C, which 
provides a massive speed boost to encoding and decoding.</p>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<div class="highlight highlight-ruby"><pre>  <span class="nb">require</span> <span class="s1">'chunky_png'</span>

  <span class="c1"># Creating an image from scratch, save as an interlaced PNG</span>
  <span class="n">png</span> <span class="o">=</span> <span class="no">ChunkyPNG</span><span class="o">::</span><span class="no">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="no">ChunkyPNG</span><span class="o">::</span><span class="no">Color</span><span class="o">::</span><span class="no">TRANSPARENT</span><span class="p">)</span>
  <span class="n">png</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="no">ChunkyPNG</span><span class="o">::</span><span class="no">Color</span><span class="o">.</span><span class="n">rgba</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
  <span class="n">png</span><span class="o">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="no">ChunkyPNG</span><span class="o">::</span><span class="no">Color</span><span class="p">(</span><span class="s1">'black @ 0.5'</span><span class="p">)</span>
  <span class="n">png</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'filename.png'</span><span class="p">,</span> <span class="ss">:interlace</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">)</span>

  <span class="c1"># Compose images using alpha blending.</span>
  <span class="n">avatar</span> <span class="o">=</span> <span class="no">ChunkyPNG</span><span class="o">::</span><span class="no">Image</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">'avatar.png'</span><span class="p">)</span>
  <span class="n">badge</span>  <span class="o">=</span> <span class="no">ChunkyPNG</span><span class="o">::</span><span class="no">Image</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">'no_ie_badge.png'</span><span class="p">)</span>
  <span class="n">avatar</span><span class="o">.</span><span class="n">compose!</span><span class="p">(</span><span class="n">badge</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
  <span class="n">avatar</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'composited.png'</span><span class="p">,</span> <span class="ss">:fast_rgba</span><span class="p">)</span> <span class="c1"># Force the fast saving routine.</span>

  <span class="c1"># Accessing metadata</span>
  <span class="n">image</span> <span class="o">=</span> <span class="no">ChunkyPNG</span><span class="o">::</span><span class="no">Image</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">'with_metadata.png'</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="n">image</span><span class="o">.</span><span class="n">metadata</span><span class="o">[</span><span class="s1">'Title'</span><span class="o">]</span>
  <span class="n">image</span><span class="o">.</span><span class="n">metadata</span><span class="o">[</span><span class="s1">'Author'</span><span class="o">]</span> <span class="o">=</span> <span class="s1">'Willem van Bergen'</span>
  <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'with_metadata.png'</span><span class="p">)</span> <span class="c1"># Overwrite file</span>

  <span class="c1"># Low level access to PNG chunks</span>
  <span class="n">png_stream</span> <span class="o">=</span> <span class="no">ChunkyPNG</span><span class="o">::</span><span class="no">Datastream</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">'filename.png'</span><span class="p">)</span>
  <span class="n">png_stream</span><span class="o">.</span><span class="n">each_chunk</span> <span class="p">{</span> <span class="o">|</span><span class="n">chunk</span><span class="o">|</span> <span class="nb">p</span> <span class="n">chunk</span><span class="o">.</span><span class="n">type</span> <span class="p">}</span>
</pre></div>

<p>For more information, see the project wiki on <a href="http://github.com/wvanbergen/chunky_png/wiki">http://github.com/wvanbergen/chunky_png/wiki</a>
or the RDOC documentation on <a href="http://rdoc.info/gems/chunky_png/frames">http://rdoc.info/gems/chunky_png/frames</a></p>

<h2>
<a name="security-warning" class="anchor" href="#security-warning"><span class="octicon octicon-link"></span></a>Security warning</h2>

<p>ChunkyPNG is vulnerable to decompression bombs, which means that ChunkyPNG is vulnerable to 
DOS attacks by running out of memory when loading a specifically crafted PNG file. Because 
of the pure-Ruby nature of the library it is very hard to fix this problem in the library 
itself.</p>

<p>In order to safely deal with untrusted images, you should make sure to do the image 
processing using ChunkyPNG in a separate process, e.g. by using fork or a background
processing library.</p>

<h2>
<a name="about" class="anchor" href="#about"><span class="octicon octicon-link"></span></a>About</h2>

<p>The library is written by Willem van Bergen for Floorplanner.com, and released
under the MIT license (see LICENSE). Please contact me for questions or
remarks. Patches are greatly appreciated!</p>

<p>Please check out the changelog on <a href="https://github.com/wvanbergen/chunky_png/wiki/Changelog">https://github.com/wvanbergen/chunky_png/wiki/Changelog</a>
to see what changed in all versions.</p>

<p>P.S.: The name of this library is intentionally similar to Chunky Bacon and 
Chunky GIF. Use Google if you want to know _why. :-)</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">ChunkyPNG maintained by <a href="https://github.com/wvanbergen">wvanbergen</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-37287278-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
